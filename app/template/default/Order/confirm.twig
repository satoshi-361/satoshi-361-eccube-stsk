{#
This file is part of EC-CUBE

Copyright(c) EC-CUBE CO.,LTD. All Rights Reserved.

http://www.ec-cube.co.jp/

For the full copyright and license information, please view the LICENSE
file that was distributed with this source code.
#}
{% extends 'default_frame.twig' %}

{% set body_class = 'registration_page' %}

{% form_theme form 'Form/form_div_layout.twig' %}

{% block stylesheet %}
    <link rel="stylesheet" href="{{ asset('assets/css/contents.css') }}" type="text/css">
    <link rel="stylesheet" href="{{ asset('assets/css/sp_top.css') }}" type="text/css">
    <style>
        .aiosl_e_res{ border: 1px #ededed solid; margin-top: 10px; margin-bottom: 10px; padding: 10px 20px; }
        .aiosl_idx{ font-weight: bold; }
        .aiosl_e_res dl { position: relative; padding-bottom: 15px; }
        .aiosl_e_res dl .aiosl_e_res_div dd:last-child{ padding-bottom:10px; border-bottom: 1px dashed lightgray; }
        .aiosl_e_res dt { position: absolute; left: 0; padding: 10px 0; }
        .aiosl_e_res dd { padding: 5px 0 5px 60px; text-align: right; color: gray; }
        .aiosl_e_res dd span { display: inline-block; vertical-align: top; }
        .aiosl_e_res dd span:last-child { color: black; padding-left: 10px; }
        #aiosl_total{ font-size: xx-large; }
        .aiosl_breakdown{ font-size: small; vertical-align: top; }
        .caution { color: red; }
        .order_info { font-size: x-large; text-align:center; }
        .order_info_span { border-bottom: thick solid lightgray; }
        .msg { margin: 50px 0px; }
        .address { margin: 20px 0px; }
        #etc { width: 100%; height: 150px; outline: none; }
        .btn_area { margin-top: 70px; text-align:center; }
        #nextBtn { width: 30%; background: gray; color: white; border: none; cursor: pointer; }

        form {
            margin-top: 30px
        }
        .form td.d-flex {
            display: flex;
        }
        .form td.d-flex input {
            width: 211px;
        }
        
        span.yubin {
            margin: 0.5714285em;
            padding: 5px 20px;
            background: #efefef;
            border: 0;
            border-radius: 3px;
            -webkit-border-radius: 3px;
            -moz-border-radius: 3px;
            cursor: pointer;
        }
        span.yubin:hover {
            background-color: #ddd;
        }
        a.btn-kind1, a.btn-kind1:hover {
            color: #ea6968
        }
        button {
            padding: 15px 3em;
            background-color: #43b8a5;
            color: #FFF;
            border: 1px;
            cursor: pointer;
            margin: 0 3px;
            font-family: source-han-sans-cjk-ja, "ヒラギノ角ゴ Pro W3", "Hiragino Kaku Gothic Pro", "メイリオ", Meiryo, Osaka, "ＭＳ Ｐゴシック", "MS PGothic", sans-serif;
            border-radius: 3px;
            -webkit-border-radius: 3px;
            -moz-border-radius: 3px;
            font-size: 16px;
            background-repeat: no-repeat;
            background-position: center;
            background-size: contain;
            width: 200px;
            height: auto;
        }
        .order-bold-info {
            font-size: 18px;
            font-weight: bold;
        }
        .agreement {
            margin-top: 20px;
            margin-left: 15px;
            display: flex;
            align-items: center;
        }

        table.orderer-location {
            width: 100%;
            border: 1px #ededed solid;
        }
        table.orderer-location th, table.orderer-location td {
            padding: 10px
        }
        
        .orderer-location .saved_address {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        @media screen and (max-width: 768px) {
            .form td.d-flex input {
                width: calc(50% - 3px);
            }
        }
    </style>
{% endblock %}

{% block javascript %}
    <script src="//yubinbango.github.io/yubinbango/yubinbango.js" charset="UTF-8"></script>
{% endblock javascript %}


{% block main %}
    <article id="main_wrap">
        <div id="breadcrumb">
            <ul>
                <li><a href="{{ url('homepage') }}">ホーム</a></li>
                <li>ご注文情報入力</li>
            </ul>
        </div>
        <section class="section form">
            <h1 class="lv_h1"><span>ご注文情報</span></h1>
            <div id="memberpages">
                <div id="newmember">
                    <div class="header_explanation">
                        <ul>
                            <li>※注意事項</li>
                            <li>・複数商品を注文する場合についても、ご注文依頼は１商品ずつ行ってください。</li>
                            <li>・別の商品にする場合は、商品ページの見積りからやり直してください。</li>
                            <li>・お支払方法は銀行振込のみとなっております。</li>
                            <li>ご注文依頼確認後、担当スタッフより≪正式見積り書 兼 請求書≫をメールにてお送りいたします。</li>
                        </ul>
                    </div><!-- .header_explanation -->
                    <div class="aiosl_e_res">
                        <dl>
                            <p class="aiosl_idx">見積金額（概算）</p>
                            <div class="aiosl_e_res_div">
                                <dt>商品名</dt>
                                <dd>
                                    <span>{{ Order['productName'] }}</span>
                                </dd>
                            </div>
                            <div class="aiosl_e_res_div">
                                <dt>色</dt>
                                <dd>
                                    <span>{{ Order['colors'] }}</span>
                                </dd>
                            </div>
                            <div class="aiosl_e_res_div">
                                <dt>商品合計</dt>
                                <dd>
                                    <span class="aiosl_breakdown">{{ Order['totalQuantity'] }}個　×　{{ Order['productPrice'] }}円</span>
                                    <span>{{ Order['totalQuantity'] * Order['productPrice'] }}円</span>
                                </dd>
                            </div>
                            <div class="aiosl_e_res_div">
                                <dt>版代</dt>
                                <dd>
                                    <span class="aiosl_breakdown">１版　×　{{ Order['dataPlacementFee'] }}円</span>
                                    <span>{{ Order['dataPlacementFee'] }}円</span>
                                </dd>
                            </div>
                            <div class="aiosl_e_res_div">
                                <dt>印刷代</dt>
                                <dd>
                                    <span class="aiosl_breakdown">{{ Order['printingFeeQuantity'] }}　×　{{ Order['printingFee'] }}円</span>
                                    <span>{{ Order['printingFeeQuantity'] * Order['printingFee'] }} 円</span>
                                </dd>
                            </div>
                            <div class="aiosl_e_res_div">
                                <dt>送料</dt>
                                <dd>
                                    <span class="aiosl_breakdown"></span>
                                    <span>{{ Order['shipmentFee'] }} 円</span>
                                </dd>
                            </div>
                            <div class="aiosl_e_res_div">
                                <dt>税抜合計</dt>
                                <dd>
                                    <span>{{ Order['zeinuki'] }} 円</span>
                                </dd>
                            </div>
                            <div class="aiosl_e_res_div">
                                <dt>消費税</dt>
                                <dd>
                                    <span id="aiosl_tax">{{ Order['tax'] }} 円</span>
                                </dd>
                            </div>
                            <div class="">
                                <dt>税込合計</dt>
                                <dd>
                                    <span>{{ Order['totalAmount'] }} 円</span>
                                </dd>
                            </div>
                        </dl>
                    </div>
                    <form method="post" action="{{ url('order_contact') }}" novalidate class="h-adr">
                        {{ form_widget(form._token) }}

                        <table class="lineBtm">
                            <tbody>
                                <tr>
                                    <th>商品に関するご要望・備考欄</th>
                                    <td>
                                        {{ form.contents.vars.data }}
                                        {{ form_widget(form.contents, { type : 'hidden' }) }}
                                    </td>
                                </tr>
                                <tr style="border-bottom: none">
                                    <th><p class="order-bold-info">注文者情報</p></th>
                                    <td></td>
                                </tr>
                                <tr>
                                    <th>お名前<span class="hissu">必須</span></th>
                                    <td class="d-flex">
                                        {{ form.name.name01.vars.data }} {# form.vars.value = form.vars.data = Customer #}
                                        {{ form.name.name02.vars.data }}
                                        {{ form_widget(form.name.name01, { type : 'hidden' }) }}
                                        {{ form_widget(form.name.name02, { type : 'hidden' }) }}    
                                    </td>
                                </tr>
                                <tr>
                                    <th>フリガナ</th>
                                    <td class="d-flex">
                                        {{ form.kana.kana01.vars.data }}
                                        {{ form.kana.kana02.vars.data }}
                                        {{ form_widget(form.kana.kana01, { type : 'hidden' }) }}
                                        {{ form_widget(form.kana.kana02, { type : 'hidden' }) }}
                                    </td>
                                </tr>
                                <tr>
                                    <th>電話番号<span class="hissu">必須</span></th>
                                    <td>{{ form.phone_number.vars.data }}
                                        {{ form_widget(form.phone_number, { type : 'hidden' }) }}
                                    </td>
                                </tr>
                                {# <tr>
                                    <th>Fax</th>
                                    <td>
                                        {{ form_widget(form.fax, { 'attr': { 'placeholder': '' } }) }}
                                        {{ form_errors(form.fax) }}
                                    </td>
                                </tr> #}
                                <tr>
                                    <th>お届け先<span class="hissu">必須</span></th>
                                    <td>〒 {{ form.postal_code.vars.data }}
                                        {{ form_widget(form.postal_code, { type : 'hidden' }) }}
                                        {# 都道府県・住所 #}
                                        {{ form.address.pref.vars.data }} {{ form.address.addr01.vars.data }} {{ form.address.addr02.vars.data }}
                                        {{ form_widget(form.address.pref, { type : 'hidden' }) }}
                                        {{ form_widget(form.address.addr01, { type : 'hidden' }) }}
                                        {{ form_widget(form.address.addr02, { type : 'hidden' }) }}
                                    </td>
                                </tr>
                                <tr>
                                    <th>メールアドレス<span class="hissu">必須</span></th>
                                    <td>
                                        {{ form.email.vars.data }}
                                        {{ form_widget(form.email, { type : 'hidden' }) }}
                                    </td>
                                </tr>
                                <input type="hidden" name="order[productName]" value="{{ Order['productName'] }}">
                                <input type="hidden" name="order[productPrice]" value="{{ Order['productPrice'] }}">
                                <input type="hidden" name="order[totalQuantity]" value="{{ Order['totalQuantity'] }}">
                                <input type="hidden" name="order[printingFee]" value="{{ Order['printingFee'] }}">
                                <input type="hidden" name="order[printingFeeQuantity]" value="{{ Order['printingFeeQuantity'] }}">
                                <input type="hidden" name="order[dataPlacementFee]" value="{{ Order['dataPlacementFee'] }}">
                                <input type="hidden" name="order[shipmentFee]" value="{{ Order['shipmentFee'] }}">
                                <input type="hidden" name="order[zeinuki]" value="{{ Order['zeinuki'] }}">
                                <input type="hidden" name="order[tax]" value="{{ Order['tax'] }}">
                                <input type="hidden" name="order[totalAmount]" value="{{ Order['totalAmount'] }}">
                                <input type="hidden" name="order[userName]" value="{{ Order['userName'] }}">
                                <input type="hidden" name="order[colors]" value="{{ Order['colors'] }}">
                            </tbody>
                        </table>
                        {% if additional != null %}
                        <p style="margin-top: 30px">お届け先情報</p>
                        <table class="lineBtm" style="margin-top: 4margin-bottom: 10px" id="additional_address">
                            <tbody>
                                <tr>
                                    <th>お名前<span class="hissu">必須</span></th>
                                    <td class="d-flex">
                                    {{ additional['name']['name01'] }} {{ additional['name']['name02'] }}
                                    <input type="hidden" id="additional_name_name01"
                                        name="additional[name][name01]" value="{{ additional['name']['name01'] }}">
                                    <input type="hidden" id="additional_name_name02"
                                        name="additional[name][name02]" value="{{ additional['name']['name02'] }}">
                                    </td>
                                </tr>
                                <tr>
                                    <th>フリガナ</th>
                                    <td class="d-flex">
                                    {{ additional['kana']['kana01'] }} {{ additional['kana']['kana02'] }}
                                    <input type="hidden" id="additional_kana_kana01"
                                         name="additional[kana][kana01]" value="{{ additional['kana']['kana01'] }}">
                                    <input type="hidden" id="additional_kana_kana02"
                                         name="additional[kana][kana02]" value="{{ additional['kana']['kana02'] }}">
                                    </td>
                                </tr>
                                <tr>
                                    <th>電話番号<span class="hissu">必須</span></th>
                                    <td>
                                    {{ additional['phone_number'] }}
                                    <input type="hidden" id="additional_phone_number"
                                         name="additional[phone_number]" value="{{ additional['phone_number'] }}">
                                    </td>
                                </tr>
                                <tr>
                                    <th>住所<span class="hissu">必須</span></th>
                                    <td>〒 {{ additional['postal_code'] }} {{ additional['address']['pref'] }}
                                        <input type="hidden" id="additional_postal_code"
                                            name="additional[postal_code]" value="{{ additional['postal_code'] }}">
                                        <input type="hidden" id="additional_address_pref"
                                            name="additional[address][pref]" value="{{ additional['address']['pref'] }}">
                                        {{ additional['address']['addr01'] }} {{ additional['address']['addr02'] }}
                                        <input type="hidden" id="additional_address_addr01"
                                            name="additional[address][addr01]" value="{{ additional['address']['addr01'] }}">
                                        <input type="hidden" id="additional_address_addr02"
                                            name="additional[address][addr02]" value="{{ additional['address']['addr02'] }}">
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        {% endif %}
                        
                        {% if is_granted('ROLE_USER') and CustomerAddress != null %}
                            <p class="order-bold-info" style="margin-top: 10px">納品先の住所</p>
                            <table class="orderer-location" style="margin-bottom: 30px">
                                <tr>
                                    <td> 
                                        <label class="saved_address" for="address_{{ CustomerAddress.id }}">
                                            <div class="ec-addressList__address">
                                                {{ CustomerAddress.name01 }}&nbsp;{{ CustomerAddress.name02 }} 様 <br/>
                                                {{ 'common.postal_symbol'|trans }}{{ CustomerAddress.postal_code }} {{ CustomerAddress.Pref }}{{ CustomerAddress.addr01 }}{{ CustomerAddress.addr02 }}<br/>
                                                {{ CustomerAddress.phone_number }}
                                            </div>
                                            <input type="hidden" id="address_{{ CustomerAddress.id }}" name="saved_address" value="{{ CustomerAddress.id }}">
                                        </label>
                                    </td>
                                </tr>
                            </table>
                        {% endif %}
                        <p class="btnSend">
                            <button class="ec-blockBtn--action" type="submit" name="mode" value="complete">注文する</button>
                            <button class="ec-blockBtn--cancel" type="submit" name="mode" value="back">{{ 'common.back'|trans }}</button>
                        </p>
                    </form>
                </div>
            </div>
        </section>
    </article>
{% endblock %}

